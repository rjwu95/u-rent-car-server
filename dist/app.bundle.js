!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("bcrypt")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t,r){r(9).config(),e.exports={development:{username:"postgres",password:"urentcargun",database:"u-rent-car-dev",host:"127.0.0.1",port:5434,dialect:"postgres",seederStorage:"sequelize",seederStorageTableName:"SequelizeData",logging:console.log},production:{username:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB,region:"ap-northeast-2",host:process.env.DB_HOST,port:process.env.DB_PORT,dialect:"postgres",seederStorage:"sequelize",seederStorageTableName:"SequelizeData",logging:!1}}},function(e,t){e.exports=require("body-parser")},function(e,t,r){r(8),e.exports=r(10)},function(e,t){e.exports=require("@babel/polyfill")},function(e,t){e.exports=require("dotenv")},function(e,t,r){"use strict";r.r(t);var n=r(3),o=r.n(n),u=r(1),a=r.n(u),c=r(0),i=r(5),s=r.n(i).a.production,p=new c.Sequelize(s.database,s.username,s.password,s),f=r(6),l=r.n(f);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(r,e);var t=v(r);function r(){return d(this,r),t.apply(this,arguments)}return r}(c.Model);g.init({number:{type:c.DataTypes.STRING},status:{type:c.DataTypes.STRING},name:{type:c.DataTypes.STRING},grade:{type:c.DataTypes.STRING},gear:{type:c.DataTypes.STRING},fuel:{type:c.DataTypes.STRING},distance:{type:c.DataTypes.STRING},remainFuel:{type:c.DataTypes.STRING},birth:{type:c.DataTypes.DATE},remark:{type:c.DataTypes.TEXT},createdAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW},updatedAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW}},{sequelize:p,modelName:"cars"});var O=g;function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=j(e);if(t){var o=j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}function S(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(r,e);var t=R(r);function r(){return T(this,r),t.apply(this,arguments)}return r}(c.Model);P.init({carId:{type:c.DataTypes.NUMBER},outerId:{type:c.DataTypes.NUMBER},renterId:{type:c.DataTypes.NUMBER},driverId:{type:c.DataTypes.NUMBER},departure:{type:c.DataTypes.DATE},arrive:{type:c.DataTypes.DATE},giveLocation:{type:c.DataTypes.STRING},carCheck:{type:c.DataTypes.STRING},initKm:{type:c.DataTypes.NUMBER},fee:{type:c.DataTypes.NUMBER},feeTable:{type:c.DataTypes.STRING},remark:{type:c.DataTypes.STRING},special:{type:c.DataTypes.STRING},createdAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW},updatedAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW}},{modelName:"contracts",sequelize:p});var x=P;function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return A(this,r)}}function A(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(r,e);var t=_(r);function r(){return I(this,r),t.apply(this,arguments)}return r}(c.Model);G.init({name:{type:c.DataTypes.STRING},birthday:{type:c.DataTypes.NUMBER},hp:{type:c.DataTypes.STRING},address:{type:c.DataTypes.STRING},detailAddress:{type:c.DataTypes.STRING},license:{type:c.DataTypes.STRING},licenseType:{type:c.DataTypes.NUMBER},licenseDate:{type:c.DataTypes.DATE},postcode:{type:c.DataTypes.STRING},createdAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW},updatedAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW}},{sequelize:p,modelName:"customers"});var q=G;function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=W(e);if(t){var o=W(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(r,e);var t=z(r);function r(){return B(this,r),t.apply(this,arguments)}return r}(c.Model);K.init({loginId:{type:c.DataTypes.STRING},password:{type:c.DataTypes.STRING},name:{type:c.DataTypes.STRING},createdAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW},updatedAt:{type:c.DataTypes.DATE,defaultValue:c.DataTypes.NOW}},{sequelize:p,modelName:"staffs"});var V=K;function L(e,t,r,n,o,u,a){try{var c=e[u](a),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,o)}function F(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){L(u,n,o,a,c,"next",e)}function c(e){L(u,n,o,a,c,"throw",e)}a(void 0)}))}}O.hasOne(x,{as:"contracts",foreignKey:"carId"}),V.hasOne(x,{as:"contracts",foreignKey:"outerId"}),q.hasOne(x,{as:"renter",foreignKey:"renterId"}),q.hasOne(x,{as:"driver",foreignKey:"driverId"}),x.belongsTo(O,{as:"car",foreignKey:"carId"}),x.belongsTo(V,{as:"outer",foreignKey:"outerId"}),x.belongsTo(q,{as:"renter",foreignKey:"renterId"}),x.belongsTo(q,{as:"driver",foreignKey:"driverId"});var H=Object(u.Router)();H.get("/",function(){var e=F(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.query.page,e.prev=1,e.next=4,O.findAll({order:[["updatedAt","DESC"]]});case 4:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r.status(500).send({error:e.t0}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),H.get("/:id",function(){var e=F(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.findOne({where:{id:Number(t.params.id)}});case 2:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),H.post("/",function(){var e=F(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body,e.prev=1,e.next=4,O.create(n);case 4:return o=e.sent,e.abrupt("return",r.status(200).send(o));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r.status(500).send({error:e.t0}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),H.patch("/",function(){var e=F(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.update(t.body,{where:{id:Number(t.body.id)}});case 2:return e.abrupt("return",r.status(200).send("success"));case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var J=H;function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,u=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw u}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ee(e,t,r,n,o,u,a){try{var c=e[u](a),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,o)}function te(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){ee(u,n,o,a,c,"next",e)}function c(e){ee(u,n,o,a,c,"throw",e)}a(void 0)}))}}var re=Object(u.Router)();re.get("/",function(){var e=te(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.findAll({attributes:["id","createdAt","departure","arrive"],include:[{model:q,as:"renter",attributes:["name","birthday","hp"]},{model:O,as:"car",attributes:["number","name"]},{model:V,as:"outer",attributes:["name"]}],order:[["updatedAt","DESC"]]});case 2:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),re.get("/:id",function(){var e=te(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.findOne({where:{id:Number(t.params.id)},include:[{model:q,as:"renter"},{model:q,as:"driver"},{model:O,as:"car"},{model:V,as:"outer"}]});case 2:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),re.post("/",function(){var e=te(regeneratorRuntime.mark((function e(t,r){var n,o,u,a,c,i,s,p,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body,o=n.renter,u=n.driver,a=n.car,e.next=3,Promise.all([q.create(o),O.findOne({where:{number:a.number}}),(null==u?void 0:u.name)&&q.create(u)]);case 3:if(c=e.sent,i=Y(c,3),s=i[0],p=i[1],f=i[2],p){e.next=12;break}return e.next=11,O.create(t.body.car);case 11:p=e.sent;case 12:return e.next=14,x.create($($({},t.body),{},{renterId:s.id,carId:p.id,driverId:f?f.id:s.id}));case 14:return l=e.sent,e.abrupt("return",r.status(200).send(l));case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),re.patch("/",function(){var e=te(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.body),e.next=3,Promise.all([x.update(t.body,{where:{id:Number(t.body.id)}}),O.update(t.body.car,{where:{id:Number(t.body.car.id)}}),q.update(t.body.renter,{where:{id:Number(t.body.renter.id)}}),q.update(t.body.driver,{where:{id:Number(t.body.driver.id)}})]);case 3:return e.abrupt("return",r.status(200).send("success"));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var ne=re;function oe(e,t,r,n,o,u,a){try{var c=e[u](a),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,o)}function ue(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){oe(u,n,o,a,c,"next",e)}function c(e){oe(u,n,o,a,c,"throw",e)}a(void 0)}))}}var ae=Object(u.Router)();ae.get("/",function(){var e=ue(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.findAll({order:[["updatedAt","DESC"]]});case 3:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",r.status(500).send({error:e.t0}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()),ae.get("/:id",function(){var e=ue(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.findOne({where:{id:Number(t.params.id)}});case 2:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),ae.patch("/",function(){var e=ue(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.update(t.body,{where:{id:Number(t.body.id)}});case 3:return e.abrupt("return",r.status(200).send("success"));case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",r.status(500).send(e.t0));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,r){return e.apply(this,arguments)}}());var ce=ae,ie=r(2),se=r.n(ie);function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e,t,r,n,o,u,a){try{var c=e[u](a),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,o)}function de(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){ye(u,n,o,a,c,"next",e)}function c(e){ye(u,n,o,a,c,"throw",e)}a(void 0)}))}}var be=Object(u.Router)();function ve(e){return new Promise((function(t,r){se.a.hash(e,process.env.SALT_ROUNDS,(function(e,n){e&&r(e),t(n)}))}))}be.get("/",function(){var e=de(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.findAll({attributes:["id","name","loginId"]});case 2:return n=e.sent,e.abrupt("return",r.status(200).send(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),be.post("/",function(){var e=de(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.findOne({where:{loginId:t.body.loginId}});case 2:if(!e.sent){e.next=5;break}return e.abrupt("return",r.status(400).send("이미 사용중인 아이디입니다."));case 5:return e.next=7,ve(t.body.password);case 7:return n=e.sent,e.next=10,V.create(fe(fe({},t.body),{},{password:n}));case 10:return o=e.sent,e.abrupt("return",r.status(200).send({id:o.id,loginId:o.loginId,name:o.name}));case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var me=be,he=r(4),ge=r.n(he);function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){Te(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e,t,r,n,o,u,a){try{var c=e[u](a),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,o)}function Re(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){De(u,n,o,a,c,"next",e)}function c(e){De(u,n,o,a,c,"throw",e)}a(void 0)}))}}var Se=Object(u.Router)();function je(e,t){return new Promise((function(r,n){se.a.compare(e,t,(function(e,t){e&&n(e),t?r(t):n(t)}))}))}Se.post("/login",function(){var e=Re(regeneratorRuntime.mark((function e(t,r){var n,o,u,a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.app.get("jwt-secret"),e.next=3,V.findOne({attributes:["id","loginId","name","password"],where:{loginId:t.body.loginId}});case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",r.status(403).send("로그인 실패"));case 6:return e.prev=6,u=o.id,a=o.loginId,c=o.name,e.next=10,je(t.body.password,o.password);case 10:return i=ge.a.sign({id:u,loginId:a,name:c},n,{expiresIn:14400}),e.abrupt("return",r.status(200).send({id:u,loginId:a,name:c,token:i}));case 14:return e.prev=14,e.t0=e.catch(6),console.log(e.t0),e.abrupt("return",r.status(403).send({message:"로그인 실패"}));case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,r){return e.apply(this,arguments)}}()),Se.get("/me",function(){var e=Re(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.app.get("jwt-secret"),e.prev=1,o=ge.a.verify(t.headers.token,n),e.abrupt("return",r.status(200).send(we(we({},o),{},{token:t.headers.token})));case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",r.status(401).send("세션 만료"));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,r){return e.apply(this,arguments)}}());var Pe=Se,xe=Object(u.Router)();xe.get("/",(function(e,t){t.status(200).send("route success")})),xe.use("/cars",J),xe.use("/contracts",ne),xe.use("/customers",ce),xe.use("/staffs",me),xe.use("/auth",Pe);var Ne=xe,Ie=a()();Ie.use(o()()),Ie.use(l.a.json());var Ee=process.env.PORT||3001;Ie.use("/api",Ne),Ie.set("jwt-secret",process.env.JWT_SECRET),Ie.listen(Ee,(function(){console.log("The server is listening on port ".concat(Ee))})),Ie.use(o()()),p.authenticate().then((function(){return console.log("√ db connection success")})).catch((function(e){return console.log("유건",e)}))}]);